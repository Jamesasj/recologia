library(Rcpp)

sourceCpp("merge.cpp",verbose=T)

mergesortC(sample(1:10))

system.time(mergesortC(sample(1:1000)))

cppFunction("
    NumericVector insertionsortC(NumericVector vetor) {
        int n = vetor.size();
 
        double aux;
        int i , j;
 
        for(i=1;i<n;i++) {
            aux=vetor[i];
            j=i-1;
            while(j>=0 && vetor[j]>aux) {
                vetor[j+1]=vetor[j];
                j=j-1;
                }
            vetor[j+1]=aux;
            }
        return vetor;
        }
")

dados<-data.frame(Tempo=rep(NA,1000),Algoritimo=rep(c("InsertionSort","MergeSort"),each=500))

for(i in 1:1000){
    if(i<=500){
        dados[i,1]<-system.time(insertionsortC(sample(1:10000)))[3]
    }else{
        dados[i,1]<-system.time(mergesortC(sample(1:10000)))[3]
    }
    print(i)
}

#Figura 1
boxplot(Tempo~Algoritimo,data=dados)

aggregate(dados$Tempo, list(dados$Algoritimo), mean)
aggregate(dados$Tempo, list(dados$Algoritimo), sd)
